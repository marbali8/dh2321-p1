<!DOCTYPE html>
<html>
  <head>
    <style>
      .title
      {
        color: red;
      }
      .title1
      {
        color: blue;
      }
      div.tooltip-donut {
       position: absolute;
       text-align: center;
       padding: .5rem;
       background: #FFFFFF;
       color: #313639;
       border: 1px solid #313639;
       border-radius: 8px;
       pointer-events: none;
       font-size: 1.3rem;
      }

      body {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-size: 11px;
        width: 1000px;
        height: 500px;
        position: relative;
      }

      svg {
      	width: 100%;
      	height: 100%;
      }

      path.slice{
      	stroke-width:2px;
      }

      polyline{
      	opacity: .3;
      	stroke: black;
      	stroke-width: 2px;
      	fill: none;
      }

    </style>
  </head>
  <body>
    <!-- <h1 class="title"> This is a heading</h1>
    <p id="par"> This is a paragraph.</p>
    <div id="scatter1"></div>

    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="script.js"></script> -->

    <button class="updatedata">updatedata</button>

    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script>

      var svg = d3.select("body").append("svg").append("g")

      svg.append("g").attr("class", "slices");
      svg.append("g").attr("class", "labels");
      svg.append("g").attr("class", "lines");

      var width = 500,
          height = 500,
      	  radius = Math.min(width, height) / 2;

      var pie = d3.layout.pie().sort(null)
      	.value(function(d) {
      		return d.value;
      	});

      var arc = d3.svg.arc()
      	.outerRadius(radius * 0.8)
      	.innerRadius(radius * 0.3);

      var outerArc = d3.svg.arc()
      	.innerRadius(radius * 0.9)
      	.outerRadius(radius * 0.9);

      svg.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

      var key = function(d) { return d.data.label; };


      function randomData (labels) {

        return labels.map(function(label) {
          return { label: label, value: 1/labels.length} //Math.random() }
        });
      }

      d3.csv("https://raw.githubusercontent.com/marbali8/dh2321-p1/master/dataset.csv", function(data) {

        var fdata = data.map(function(d) {
          return {
            "name": d.Alias,
            "music interest": d["I-Music"],
            "movie interest": d["I-Movies"],
            "travel interest": d["I-Travel"],
            "photo interest": d["I-Photo"],
            "sport interest": d["I-Sport"],
            "paint interest": d["I-Painting"],
            "book interest": d["I-Books"],
            "food/nutrition interest": d["I-Food"],
            "programming interest": d["I-Programming"],
            "ux interest": d["I-UX"],
            "gamming interest": d["I-Gamming"],
            "game dev interest": d["I-GameDev"],
            "travel interest": d["I-Travel"],
            "dance interest": d["I-Dance"],
            "art/design interest": d["I-Art/Design"],
            "visualization interest": d["I-Vis"],
            "science interest": d["I-Science"],
            "create interest": d["I-Create"],
            "nature / sustainability interest": d["I-Nat/Sust"],
            "technology interest": d["I-Tech"],
            "information visualization": d.InfVis,
            "statistics": d.Stat,
            "mathematics": d.Math,
            "artistic": d.Art,
            "computers": d.PC,
            "programming": d.Prog,
            "computer graphics": d.PCGraph,
            "human-computer interaction": d.HPCInter,
            "user experience": d.UX,
            "communication": d.Comm,
            "collaborating": d.Collab,
            "repositories": d.Repo
          }
        });
        var colors = [];
        var names = fdata.map(function(d) { return d["name"] });
        for (var i = 0; i < names.length; i++) colors.push(Math.floor(Math.random()*16777215).toString(16));

        var color = d3.scale.ordinal()
          .domain(names)
          .range(colors);

        d3.select(".updatedata")
        	.on("click", function(){
        		change(fdata, randomData(names));
        	});

        change(fdata, randomData(names));

        function change(fdata, names) {

        	/* ------- PIE SLICES -------*/
        	var slice = svg.select(".slices").selectAll("path.slice")
        		.data(pie(names), key);

          var div = d3.select("body").append("div")
            .attr("class", "tooltip-donut")
            .style("opacity", 0);

        	slice.enter()
        		.insert("path")
        		.style("fill", function(d) { return color(d.data.label); })
        		.attr("class", "slice")

            .on('mouseover', function (d, i) {
              d3.select(this).transition()
                .duration('50')
                .attr('opacity', '.85');
              div.transition()
                .duration(50)
                .style("opacity", 1);

              div.text(names[i].label)
                .style("left", (d3.event.pageX + 10) + "px")
                .style("top", (d3.event.pageY - 15) + "px");
            })

            .on('mouseout', function (d, i) {
              d3.select(this).transition()
                .duration('50')
                .attr('opacity', '1');
              div.transition()
                .duration('50')
                .style("opacity", 0);
     });

        	slice
        		.transition().duration(1000)
        		.attrTween("d", function(d) {
        			this._current = this._current || d;
        			var interpolate = d3.interpolate(this._current, d);
        			this._current = interpolate(0);
        			return function(t) {
        				return arc(interpolate(t));
        			};
        		})

        	slice.exit()
        		.remove();
        };

      })

    </script>
    </body>
</html>

<!-- we want to be close on interest, and find people that have skills that we lack
so  -->
